<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒé«˜ä¸­æ–°é¢–æ´å¯Ÿ</title>
    <!-- Google Fonts: Inter and Noto Sans SC -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='img/favicon/NIGH.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
        .dashboard-container {
            margin-top: 60px;
            padding: 20px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .dashboard-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: var(--vp-c-text-light-1);
        }

        .dashboard-header .showTime {
            font-size: 1rem;
            color: var(--vp-c-text-light-2);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 2rem;
        }

        .dashboard-chart-container {
            background: var(--vp-c-bg-elv);
            border-radius: var(--vp-radius);
            padding: 20px;
            box-shadow: var(--vp-shadow-2);
            border: 1px solid var(--vp-c-border);
            transition: var(--transition);
        }

        .dashboard-chart-container:hover {
            transform: translateY(-5px);
            box-shadow: var(--vp-shadow-4);
        }

        .chart-header {
            margin-bottom: 15px;
        }

        .chart-header h2 {
            font-size: 1.5rem;
            color: var(--vp-c-text-light-1);
            margin: 0;
        }

        .chart-container {
            width: 100%;
            height: 400px;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-brand">
                <a href="{{ url_for('index') }}" class="nav-brand-link">
                    <img src="{{ url_for('static', filename='img/favicon/NIGH.png') }}" alt="NIGH Logo" class="logo">
                    <h1>å…¨çƒé«˜ä¸­æ–°é¢–æ´å¯Ÿ</h1>
                </a>
            </div>
            <div class="nav-center">
                <div class="nav-links">
                    <a href="{{ url_for('index') }}" class="nav-link">é¦–é¡µ</a>
                    <a href="#" class="nav-link">åŠŸèƒ½</a>
                    <a href="#" class="nav-link">æ•°æ®</a>
                    <a href="#" class="nav-link">AIè§£è¯»</a>
                </div>
            </div>
            <div class="auth-buttons">
                <div class="theme-toggle" id="theme-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="theme-icon-when-light">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="theme-icon-when-dark">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x1="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </div>
                <a href="{{ url_for('login') }}" class="btn btn-outline">ç™»å½•</a>
                <a href="{{ url_for('register') }}" class="btn btn-primary">æ³¨å†Œ</a>
            </div>
            <div class="hamburger" id="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
        <div class="mobile-menu" id="mobile-menu">
            <button class="close-menu" id="close-menu-btn">âœ•</button>
            <div class="mobile-theme-toggle">
                <div class="theme-toggle" id="mobile-theme-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="theme-icon-when-light">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="theme-icon-when-dark">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </div>
            </div>
            <div class="nav-links">
                <a href="{{ url_for('index') }}" class="nav-link">é¦–é¡µ</a>
                <a href="#" class="nav-link">åŠŸèƒ½</a>
                <a href="#" class="nav-link">æ•°æ®</a>
                <a href="#" class="nav-link">AIè§£è¯»</a>
            </div>
            <div class="auth-buttons">
                <a href="{{ url_for('login') }}" class="btn btn-outline">ç™»å½•</a>
                <a href="{{ url_for('register') }}" class="btn btn-primary">æ³¨å†Œ</a>
            </div>
        </div>
        <div class="mobile-menu-backdrop" id="mobile-menu-backdrop"></div>
    </header>

    <main class="dashboard-container">
        <div class="dashboard-header">
            <h1>æ•°æ®å¯è§†åŒ–ä»ªè¡¨æ¿</h1>
            <div class="showTime" id="currentTime"></div>
        </div>

        <div class="dashboard-grid">
            <!-- å·¦ä¸Šè§’ - å„å›½å­¦æ ¡æ•°é‡é¥¼å›¾ -->
            <div class="dashboard-chart-container">
                <div class="chart-header">
                    <h2>å„å›½å­¦æ ¡æ•°é‡</h2>
                </div>
                <div class="chart-container" id="schoolCountChart"></div>
            </div>

            <!-- å³ä¸Šè§’ - å­¦è´¹ç»Ÿè®¡æŸ±çŠ¶å›¾ -->
            <div class="dashboard-chart-container">
                <div class="chart-header">
                    <h2>å­¦è´¹ç»Ÿè®¡æƒ…å†µ</h2>
                </div>
                <div class="chart-container" id="tuitionChart"></div>
            </div>

            <!-- å·¦ä¸‹è§’ - å­¦ç§‘å¼€è®¾æƒ…å†µæ°”æ³¡å›¾ -->
            <div class="dashboard-chart-container">
                <div class="chart-header">
                    <h2>å­¦ç§‘å¼€è®¾æƒ…å†µç»Ÿè®¡</h2>
                </div>
                <div class="chart-container" id="subjectChart"></div>
            </div>

            <!-- å³ä¸‹è§’ - å­¦æ ¡å­˜åœ¨æ—¶é—´æŠ˜çº¿å›¾ -->
            <div class="dashboard-chart-container">
                <div class="chart-header">
                    <h2>å­¦æ ¡å­˜åœ¨æ—¶é—´ç»Ÿè®¡</h2>
                </div>
                <div class="chart-container" id="ageChart"></div>
            </div>
        </div>
    </main>

    <!-- å¼•å…¥ ECharts åº“ -->
    <script src="{{ url_for('static', filename='js/echarts.min.js') }}"></script>

    <!-- æœç´¢æ‚¬æµ®æŒ‰é’®æ ·å¼ -->
    <style>
        .search-float-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .search-trigger {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            transition: all 0.3s ease;
        }

        .search-trigger:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .search-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1001;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .search-box {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        .search-results {
            max-height: 400px;
            overflow-y: auto;
        }

        .result-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }

        .result-item:hover {
            background-color: #f5f5f5;
        }

        .result-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .result-content {
            color: #666;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .close-search {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .close-search:hover {
            color: #333;
        }
    </style>

    <!-- æœç´¢æ‚¬æµ®æŒ‰é’®å’Œæ¨¡æ€æ¡† -->
    <div class="search-float-container">
        <button class="search-trigger" id="searchTrigger" title="ç‚¹å‡»æœç´¢">
            ğŸ”
        </button>
    </div>

    <div class="search-modal" id="searchModal">
        <div class="search-box">
            <span class="close-search" id="closeSearch">&times;</span>
            <input type="text" class="search-input" id="searchInput" placeholder="è¾“å…¥å…³é”®è¯æœç´¢æ–‡ç« ..." />
            <div class="search-results" id="searchResults"></div>
        </div>
    </div>

    <!-- é¡µé¢è„šæœ¬ -->
    <script>
        // å®æ—¶æ—¶é—´æ›´æ–°
        function updateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');

            document.getElementById('currentTime').textContent =
                `å½“å‰æ—¶é—´: ${year}å¹´${month}æœˆ${day}æ—¥ ${hours}æ—¶${minutes}åˆ†${seconds}ç§’`;
        }

        // æœç´¢åŠŸèƒ½
        function setupSearch() {
            const searchTrigger = document.getElementById('searchTrigger');
            const searchModal = document.getElementById('searchModal');
            const closeSearch = document.getElementById('closeSearch');
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');

            // æ‰“å¼€æœç´¢æ¡†
            searchTrigger.addEventListener('click', function() {
                searchModal.style.display = 'flex';
                searchInput.focus();
            });

            // å…³é—­æœç´¢æ¡†
            closeSearch.addEventListener('click', function() {
                searchModal.style.display = 'none';
                searchInput.value = '';
                searchResults.innerHTML = '';
            });

            // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
            searchModal.addEventListener('click', function(e) {
                if (e.target === searchModal) {
                    searchModal.style.display = 'none';
                    searchInput.value = '';
                    searchResults.innerHTML = '';
                }
            });

            // æœç´¢è¾“å…¥äº‹ä»¶
            let searchTimeout;
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                const query = this.value.trim();

                if (query.length === 0) {
                    searchResults.innerHTML = '';
                    return;
                }

                // å»¶è¿Ÿæœç´¢ï¼Œé¿å…é¢‘ç¹è¯·æ±‚
                searchTimeout = setTimeout(() => {
                    performSearch(query);
                }, 500);
            });

            // æ‰§è¡Œæœç´¢
            async function performSearch(query) {
                try {
                    const response = await fetch(`/search?q=${encodeURIComponent(query)}`);
                    const results = await response.json();

                    displaySearchResults(results);
                } catch (error) {
                    console.error('æœç´¢å‡ºé”™:', error);
                    searchResults.innerHTML = '<div class="result-item">æœç´¢å‡ºç°é”™è¯¯ï¼Œè¯·ç¨åå†è¯•</div>';
                }
            }

            // æ˜¾ç¤ºæœç´¢ç»“æœ
            function displaySearchResults(results) {
                searchResults.innerHTML = '';

                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="result-item">æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</div>';
                    return;
                }

                results.forEach(result => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'result-item';
                    resultItem.innerHTML = `
                        <div class="result-title">${result.title || 'æ— æ ‡é¢˜'}</div>
                        <div class="result-content">${result.content ? result.content.substring(0, 100) + '...' : ''}</div>
                    `;
                    resultItem.addEventListener('click', function() {
                        // åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€æ–‡ç« è¯¦æƒ…ï¼ˆè¿™é‡Œå¯ä»¥æ”¹ä¸ºå…·ä½“çš„æ–‡ç« è¯¦æƒ…é¡µé¢ï¼‰
                        // å¯¹äºç°åœ¨ï¼Œæˆ‘ä»¬åªæ˜¯æ˜¾ç¤ºæ–‡ç« å†…å®¹åœ¨alertä¸­
                        alert(`æ ‡é¢˜: ${result.title}\n\nå†…å®¹: ${result.content ? result.content.substring(0, 200) + '...' : 'æ— å†…å®¹'}`);
                    });
                    searchResults.appendChild(resultItem);
                });
            }
        }

        // åˆå§‹è°ƒç”¨å¹¶è®¾ç½®å®šæ—¶å™¨
        updateTime();
        setInterval(updateTime, 1000);

        // åˆå§‹åŒ– ECharts å›¾è¡¨å’Œæœç´¢åŠŸèƒ½
        window.onload = function() {
            setupSearch();

            // å„å›½å­¦æ ¡æ•°é‡é¥¼å›¾
            const schoolCountChart = echarts.init(document.getElementById('schoolCountChart'));
            const schoolCountOption = {
                title: {
                    text: 'å…±ç»Ÿè®¡æ’åå‰180æ‰€',
                    subtext: '',
                    left: 'center',
                    top: 10
                },
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    top: '10%'
                },
                series: [
                    {
                        name: 'åœ°åŒºå­¦æ ¡æ•°é‡',
                        type: 'pie',
                        radius: '60%',
                        center: ['60%', '50%'],
                        data: [
                            { value: 79, name: 'ç¾å›½' },
                            { value: 15, name: 'ä¸­å›½' },
                            { value: 1, name: 'åŠ æ‹¿å¤§' },
                            { value: 73, name: 'è‹±å›½' },
                            { value: 1, name: 'å°åº¦' },
                            { value: 10, name: 'æ—¥æœ¬' },
                            { value: 2, name: 'éŸ©å›½' },
                            { value: 1, name: 'é˜¿è”é…‹' },
                            { value: 2, name: 'æ–°åŠ å¡' },
                            { value: 1, name: 'ç‘å£«' }
                        ],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                ]
            };
            schoolCountChart.setOption(schoolCountOption);

            // å­¦ç§‘å¼€è®¾æƒ…å†µæ°”æ³¡å›¾
            const subjectChart = echarts.init(document.getElementById('subjectChart'));
            const dataBJ = [
                [1, 55, 9, 56, 0.46, 18, 6, 'è‰¯'],
                [2, 25, 11, 21, 0.65, 34, 9, 'ä¼˜'],
                [3, 56, 7, 63, 0.3, 14, 5, 'è‰¯'],
                [4, 33, 7, 29, 0.33, 16, 6, 'ä¼˜'],
                [5, 42, 24, 44, 0.76, 40, 16, 'ä¼˜'],
                [6, 82, 58, 90, 1.77, 68, 33, 'è‰¯'],
                [7, 74, 49, 77, 1.46, 48, 27, 'è‰¯'],
                [8, 78, 55, 80, 1.29, 59, 29, 'è‰¯'],
                [9, 267, 216, 280, 4.8, 108, 64, 'é‡åº¦æ±¡æŸ“'],
                [10, 185, 127, 216, 2.52, 61, 27, 'ä¸­åº¦æ±¡æŸ“'],
                [11, 39, 19, 38, 0.57, 31, 15, 'ä¼˜'],
                [12, 41, 11, 40, 0.43, 21, 7, 'ä¼˜'],
                [13, 64, 38, 74, 1.04, 46, 22, 'è‰¯'],
                [14, 108, 79, 120, 1.7, 75, 41, 'è½»åº¦æ±¡æŸ“'],
                [15, 108, 63, 116, 1.48, 44, 26, 'è½»åº¦æ±¡æŸ“'],
                [16, 33, 6, 29, 0.34, 13, 5, 'ä¼˜'],
                [17, 94, 66, 110, 1.54, 62, 31, 'è‰¯'],
                [18, 186, 142, 192, 3.88, 93, 79, 'ä¸­åº¦æ±¡æŸ“'],
                [19, 57, 31, 54, 0.96, 32, 14, 'è‰¯'],
                [20, 22, 8, 17, 0.48, 23, 10, 'ä¼˜'],
                [21, 39, 15, 36, 0.61, 29, 13, 'ä¼˜'],
                [22, 94, 69, 114, 2.08, 73, 39, 'è‰¯'],
                [23, 99, 73, 110, 2.43, 76, 48, 'è‰¯'],
                [24, 31, 12, 30, 0.5, 32, 16, 'ä¼˜'],
                [25, 42, 27, 43, 1, 53, 22, 'ä¼˜'],
                [26, 154, 117, 157, 3.05, 92, 58, 'ä¸­åº¦æ±¡æŸ“'],
                [27, 234, 185, 230, 4.09, 123, 69, 'é‡åº¦æ±¡æŸ“'],
                [28, 160, 120, 186, 2.77, 91, 50, 'ä¸­åº¦æ±¡æŸ“'],
                [29, 134, 96, 165, 2.76, 83, 41, 'è½»åº¦æ±¡æŸ“'],
                [30, 52, 24, 60, 1.03, 50, 21, 'è‰¯'],
                [31, 46, 5, 49, 0.28, 10, 6, 'ä¼˜']
            ];
            const dataGZ = [
                [1, 26, 37, 27, 1.163, 27, 13, 'ä¼˜'],
                [2, 85, 62, 71, 1.195, 60, 8, 'è‰¯'],
                [3, 78, 38, 74, 1.363, 37, 7, 'è‰¯'],
                [4, 21, 21, 36, 0.634, 40, 9, 'ä¼˜'],
                [5, 41, 42, 46, 0.915, 81, 13, 'ä¼˜'],
                [6, 56, 52, 69, 1.067, 92, 16, 'è‰¯'],
                [7, 64, 30, 28, 0.924, 51, 2, 'è‰¯'],
                [8, 55, 48, 74, 1.236, 75, 26, 'è‰¯'],
                [9, 76, 85, 113, 1.237, 114, 27, 'è‰¯'],
                [10, 91, 81, 104, 1.041, 56, 40, 'è‰¯'],
                [11, 84, 39, 60, 0.964, 25, 11, 'è‰¯'],
                [12, 64, 51, 101, 0.862, 58, 23, 'è‰¯'],
                [13, 70, 69, 120, 1.198, 65, 36, 'è‰¯'],
                [14, 77, 105, 178, 2.549, 64, 16, 'è‰¯'],
                [15, 109, 68, 87, 0.996, 74, 29, 'è½»åº¦æ±¡æŸ“'],
                [16, 73, 68, 97, 0.905, 51, 34, 'è‰¯'],
                [17, 54, 27, 47, 0.592, 53, 12, 'è‰¯'],
                [18, 51, 61, 97, 0.811, 65, 19, 'è‰¯'],
                [19, 91, 71, 121, 1.374, 43, 18, 'è‰¯'],
                [20, 73, 102, 182, 2.787, 44, 19, 'è‰¯'],
                [21, 73, 50, 76, 0.717, 31, 20, 'è‰¯'],
                [22, 84, 94, 140, 2.238, 68, 18, 'è‰¯'],
                [23, 93, 77, 104, 1.165, 53, 7, 'è‰¯'],
                [24, 99, 130, 227, 3.97, 55, 15, 'è‰¯'],
                [25, 146, 84, 139, 1.094, 40, 17, 'è½»åº¦æ±¡æŸ“'],
                [26, 113, 108, 137, 1.481, 48, 15, 'è½»åº¦æ±¡æŸ“'],
                [27, 81, 48, 62, 1.619, 26, 3, 'è‰¯'],
                [28, 56, 48, 68, 1.336, 37, 9, 'è‰¯'],
                [29, 82, 92, 174, 3.29, 0, 13, 'è‰¯'],
                [30, 106, 116, 188, 3.628, 101, 16, 'è½»åº¦æ±¡æŸ“'],
                [31, 118, 50, 0, 1.383, 76, 11, 'è½»åº¦æ±¡æŸ“']
            ];
            const dataSH = [
                [1, 91, 45, 125, 0.82, 34, 23, 'è‰¯'],
                [2, 65, 27, 78, 0.86, 45, 29, 'è‰¯'],
                [3, 83, 60, 84, 1.09, 73, 27, 'è‰¯'],
                [4, 109, 81, 121, 1.28, 68, 51, 'è½»åº¦æ±¡æŸ“'],
                [5, 106, 77, 114, 1.07, 55, 51, 'è½»åº¦æ±¡æŸ“'],
                [6, 109, 81, 121, 1.28, 68, 51, 'è½»åº¦æ±¡æŸ“'],
                [7, 106, 77, 114, 1.07, 55, 51, 'è½»åº¦æ±¡æŸ“'],
                [8, 89, 65, 78, 0.86, 51, 26, 'è‰¯'],
                [9, 53, 33, 47, 0.64, 50, 17, 'è‰¯'],
                [10, 80, 55, 80, 1.01, 75, 24, 'è‰¯'],
                [11, 117, 81, 124, 1.03, 45, 24, 'è½»åº¦æ±¡æŸ“'],
                [12, 99, 71, 142, 1.1, 62, 42, 'è‰¯'],
                [13, 95, 69, 130, 1.28, 74, 50, 'è‰¯'],
                [14, 116, 87, 131, 1.47, 84, 40, 'è½»åº¦æ±¡æŸ“'],
                [15, 108, 80, 121, 1.3, 85, 37, 'è½»åº¦æ±¡æŸ“'],
                [16, 134, 83, 167, 1.16, 57, 43, 'è½»åº¦æ±¡æŸ“'],
                [17, 79, 43, 107, 1.05, 59, 37, 'è‰¯'],
                [18, 71, 46, 89, 0.86, 64, 25, 'è‰¯'],
                [19, 97, 71, 113, 1.17, 88, 31, 'è‰¯'],
                [20, 84, 57, 91, 0.85, 55, 31, 'è‰¯'],
                [21, 87, 63, 101, 0.9, 56, 41, 'è‰¯'],
                [22, 104, 77, 119, 1.09, 73, 48, 'è½»åº¦æ±¡æŸ“'],
                [23, 87, 62, 100, 1, 72, 28, 'è‰¯'],
                [24, 168, 128, 172, 1.49, 97, 56, 'ä¸­åº¦æ±¡æŸ“'],
                [25, 65, 45, 51, 0.74, 39, 17, 'è‰¯'],
                [26, 39, 24, 38, 0.61, 47, 17, 'ä¼˜'],
                [27, 39, 24, 39, 0.59, 50, 19, 'ä¼˜'],
                [28, 93, 68, 96, 1.05, 79, 29, 'è‰¯'],
                [29, 188, 143, 197, 1.66, 99, 51, 'ä¸­åº¦æ±¡æŸ“'],
                [30, 174, 131, 174, 1.55, 108, 50, 'ä¸­åº¦æ±¡æŸ“'],
                [31, 187, 143, 201, 1.39, 89, 53, 'ä¸­åº¦æ±¡æŸ“']
            ];
            const schema = [
                { name: 'date', index: 0, text: 'æ—¥' },
                { name: 'AQIindex', index: 1, text: 'AQIæŒ‡æ•°' },
                { name: 'PM25', index: 2, text: 'PM2.5' },
                { name: 'PM10', index: 3, text: 'PM10' },
                { name: 'CO', index: 4, text: 'ä¸€æ°§åŒ–ç¢³ï¼ˆCOï¼‰' },
                { name: 'NO2', index: 5, text: 'äºŒæ°§åŒ–æ°®ï¼ˆNO2ï¼‰' },
                { name: 'SO2', index: 6, text: 'äºŒæ°§åŒ–ç¡«ï¼ˆSO2ï¼‰' }
            ];
            const itemStyle = {
                opacity: 0.8,
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowOffsetY: 0,
                shadowColor: 'rgba(0,0,0,0.3)'
            };
            const subjectOption = {
                color: ['#dd4444', '#fec42c', '#80F1BE'],
                legend: {
                    top: 10,
                    data: ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·'],
                    textStyle: {
                        fontSize: 16
                    }
                },
                grid: {
                    left: '10%',
                    right: 150,
                    top: '18%',
                    bottom: '15%'
                },
                tooltip: {
                    backgroundColor: 'rgba(255,255,255,0.7)',
                    formatter: function (param) {
                        const value = param.value;
                        return '<div style="border-bottom: 1px solid rgba(255,255,255,.3); font-size: 18px;padding-bottom: 7px;margin-bottom: 7px">'
                            + param.seriesName + ' ' + value[0] + 'æ—¥ï¼š'
                            + value[7]
                            + '</div>'
                            + schema[1].text + 'ï¼š' + value[1] + '<br>'
                            + schema[2].text + 'ï¼š' + value[2] + '<br>'
                            + schema[3].text + 'ï¼š' + value[3] + '<br>'
                            + schema[4].text + 'ï¼š' + value[4] + '<br>'
                            + schema[5].text + 'ï¼š' + value[5] + '<br>'
                            + schema[6].text + 'ï¼š' + value[6] + '<br>';
                    }
                },
                xAxis: {
                    type: 'value',
                    name: 'æ—¥æœŸ',
                    nameGap: 16,
                    nameTextStyle: {
                        fontSize: 16
                    },
                    max: 31,
                    splitLine: {
                        show: false
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'AQIæŒ‡æ•°',
                    nameLocation: 'end',
                    nameGap: 20,
                    nameTextStyle: {
                        fontSize: 16
                    },
                    splitLine: {
                        show: false
                    }
                },
                dataZoom: [
                    {
                        type: 'slider',
                        show: true,
                        xAxisIndex: [0],
                        start: 0,
                        end: 100,
                        bottom: '5%',
                        height: 20
                    },
                    {
                        type: 'slider',
                        show: true,
                        yAxisIndex: [0],
                        start: 0,
                        end: 100,
                        right: 120,
                        width: 20
                    },
                    {
                        type: 'inside',
                        xAxisIndex: [0],
                        start: 0,
                        end: 100
                    },
                    {
                        type: 'inside',
                        yAxisIndex: [0],
                        start: 0,
                        end: 100
                    }
                ],
                visualMap: [
                    {
                        left: 'right',
                        top: '10%',
                        dimension: 2,
                        min: 0,
                        max: 250,
                        itemWidth: 30,
                        itemHeight: 120,
                        calculable: true,
                        precision: 0.1,
                        text: ['åœ†å½¢å¤§å°ï¼šPM2.5'],
                        textGap: 30,
                        inRange: {
                            symbolSize: [10, 70]
                        },
                        outOfRange: {
                            symbolSize: [10, 70],
                            color: ['rgba(255,255,255,0.4)']
                        },
                        controller: {
                            inRange: {
                                color: ['#c23531']
                            },
                            outOfRange: {
                                color: ['#999']
                            }
                        }
                    },
                    {
                        left: 'right',
                        bottom: '5%',
                        dimension: 6,
                        min: 0,
                        max: 50,
                        itemHeight: 120,
                        text: ['æ˜æš—ï¼šäºŒæ°§åŒ–ç¡«'],
                        textGap: 30,
                        inRange: {
                            colorLightness: [0.9, 0.5]
                        },
                        outOfRange: {
                            color: ['rgba(255,255,255,0.4)']
                        },
                        controller: {
                            inRange: {
                                color: ['#c23531']
                            },
                            outOfRange: {
                                color: ['#999']
                            }
                        }
                    }
                ],
                series: [
                    {
                        name: 'åŒ—äº¬',
                        type: 'scatter',
                        itemStyle: itemStyle,
                        data: dataBJ
                    },
                    {
                        name: 'ä¸Šæµ·',
                        type: 'scatter',
                        itemStyle: itemStyle,
                        data: dataSH
                    },
                    {
                        name: 'å¹¿å·',
                        type: 'scatter',
                        itemStyle: itemStyle,
                        data: dataGZ
                    }
                ]
            };
            subjectChart.setOption(subjectOption);

            // å­¦è´¹ç»Ÿè®¡æŸ±çŠ¶å›¾
            const tuitionChart = echarts.init(document.getElementById('tuitionChart'));
            const tuitionOption = {
                title: {
                    text: 'å­¦è´¹ç»Ÿè®¡æƒ…å†µ',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['å­¦è´¹èŒƒå›´', 'å­¦æ ¡æ•°é‡'],
                    top: '10%'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['$0-1ä¸‡', '$1-2ä¸‡', '$2-3ä¸‡', '$3-4ä¸‡', '$4-5ä¸‡', '$5ä¸‡ä»¥ä¸Š']
                },
                yAxis: {
                    type: 'value',
                    name: 'å­¦æ ¡æ•°é‡'
                },
                series: [
                    {
                        name: 'å­¦æ ¡æ•°é‡',
                        type: 'bar',
                        data: [5, 12, 25, 40, 30, 15],
                        itemStyle: {
                            color: '#5470c6'
                        }
                    }
                ]
            };
            tuitionChart.setOption(tuitionOption);

            // å­¦æ ¡å­˜åœ¨æ—¶é—´æŠ˜çº¿å›¾
            const ageChart = echarts.init(document.getElementById('ageChart'));
            const years = [1950, 1955, 1960, 1965, 1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2020];
            const counts = [2, 5, 8, 12, 15, 18, 22, 25, 20, 15, 10, 8, 5, 3, 1];
            const cumulative = [2, 7, 15, 27, 42, 60, 82, 107, 127, 142, 152, 160, 165, 168, 169];
            const ageOption = {
                title: {
                    text: 'å­¦æ ¡å­˜åœ¨æ—¶é—´ç»Ÿè®¡',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        crossStyle: {
                            color: '#999'
                        }
                    },
                    formatter: function(params) {
                        let result = `${params[0].name}å¹´<br/>`;
                        params.forEach(param => {
                            const marker = `<span style="display:inline-block;margin-right:5px;border-radius:50%;width:10px;height:10px;background-color:${param.color}"></span>`;
                            if (param.seriesName === 'å¹´åº¦æˆç«‹æ•°é‡') {
                                result += `${marker}${param.seriesName}: ${param.value}æ‰€<br/>`;
                            } else {
                                result += `${marker}${param.seriesName}: ${param.value}æ‰€<br/>`;
                            }
                        });
                        return result;
                    }
                },
                legend: {
                    data: ['å¹´åº¦æˆç«‹æ•°é‡', 'ç´¯ç§¯å­¦æ ¡æ•°é‡'],
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '12%',
                    top: '20%',
                    containLabel: true
                },
                xAxis: [
                    {
                        type: 'category',
                        data: years,
                        axisPointer: {
                            type: 'shadow'
                        },
                        axisLabel: {
                            interval: Math.ceil(years.length / 10) - 1,
                            rotate: 45
                        }
                    }
                ],
                yAxis: [
                    {
                        type: 'value',
                        name: 'å­¦æ ¡æ•°é‡',
                        min: 0,
                        axisLabel: {
                            formatter: '{value} æ‰€'
                        }
                    },
                    {
                        type: 'value',
                        name: 'ç´¯ç§¯å­¦æ ¡æ•°é‡',
                        min: 0,
                        axisLabel: {
                            formatter: '{value} æ‰€'
                        }
                    }
                ],
                dataZoom: [
                    {
                        type: 'slider',
                        show: true,
                        xAxisIndex: [0],
                        start: 0,
                        end: 100,
                        bottom: '5%'
                    },
                    {
                        type: 'inside',
                        xAxisIndex: [0],
                        start: 0,
                        end: 100
                    }
                ],
                series: [
                    {
                        name: 'å¹´åº¦æˆç«‹æ•°é‡',
                        type: 'bar',
                        data: counts,
                        itemStyle: {
                            color: '#5470c6'
                        },
                        emphasis: {
                            focus: 'series'
                        }
                    },
                    {
                        name: 'ç´¯ç§¯å­¦æ ¡æ•°é‡',
                        type: 'line',
                        yAxisIndex: 1,
                        data: cumulative,
                        itemStyle: {
                            color: '#ee6666'
                        },
                        lineStyle: {
                            width: 3
                        },
                        symbol: 'circle',
                        symbolSize: 6,
                        emphasis: {
                            focus: 'series'
                        }
                    }
                ]
            };
            ageChart.setOption(ageOption);

            // ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼Œè°ƒæ•´å›¾è¡¨å¤§å°
            window.addEventListener('resize', function() {
                schoolCountChart.resize();
                subjectChart.resize();
                tuitionChart.resize();
                ageChart.resize();
            });
        };
    </script>
</body>
</html>